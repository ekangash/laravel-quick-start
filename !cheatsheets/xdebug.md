# Настройка xDebug в PhpStorm для проекта, работающего в контексте Docker-контейнера
Настройка xDebug в PhpStorm для проекта, работающего в контексте Docker-контейнера, включает в себя настройку докера,
сервера, отладчика и интерпретатора из контейнера в PhpStorm. Для этого необходимо выполнить несколько простых шагов,
которые позволят установить соединение, и настроить окружение для успешной отладки. Следующие инструкции помогут настроить 
среду для отладки PHP приложений в PhpStorm в контексте Docker-контейнера.

### 1. Настройка работы Docker в PhpStorm
Перейдите в меню `File -> Settings -> Build, Execution, Deployment -> Docker`, нажмите плюс в левом верхнем углу окна настроек и убедитесь, 
что PhpStorm успешно установил соединение с Docker-контейнером на хосте.
Если вы видите сообщение "Connection successful", значит, соединение установлено и все работает стабильно.

### 2. Настройка сервера в PhpStorm

Перейдите в меню `File -> Settings -> PHP -> Servers`.
- Чтобы добавить новый сервер, нажмите кнопку "+". Укажите следующие параметры:
    - **Name**: значение `serverName` свойства в переменной окружения `PHP_IDE_CONFIG` контейнера `php-fpm`.
    - **Host**: Хост-сервер, на котором запущено приложение, обычно это `localhost`.
    - **Port**: Хост-порт, на котором запущено приложение, указан у сервиса контейнера `nginx`.
- Установите галочку **Use path mappings**. В интерфейсе окна добавьте локальный путь до приложения **path to app**
  и настройте **Absolute path on the server** на `/var/www/www`, путь до файлов в контейнере.
  
### 3. Настройка отладчика в PhpStorm
Перейдите во вкладку **Debug** (`File -> Settings -> PHP -> Debug`) и снимите галочки со всех 
опций **Force break at first line when**, и любых других опций, если они были включены.

### 4. Настройка интерпретатора из контейнера в PhpStorm

Перейдите во вкладку **PHP** (`File -> Settings -> PHP`) и заполните следующие поля:

- **PHP language level**: Укажите версию 8.0.
- **CLI Interpreter**: Нажмите на кнопку `...` справа. В появившемся окне выполните следующие действия:

    - Нажмите на кнопку добавления нового `CLI Interpreter` (значок плюса в левом верхнем углу).
    - В появившемся окне выберите **From Docker**, а в открывшемся окне выбрать:
        - Для операционных систем на базе Linux выберите **Docker Compose**, затем добавьте новый сервер Docker в разделе **Server**
          (нажав на кнопку `New` и оставив параметры по умолчанию), а затем выберите **app** в списке служб.
        - Для операционных систем на базе Windows выберите **Docker**, затем добавьте новый сервер Docker в разделе **Server**
          (нажав на кнопку `New` и оставив параметры по умолчанию), а затем выберите **app:latest** в списке служб.

Чтобы проверить результаты, поставьте точку остановки в файле `bootstrap/app.php`, включите режим отладки (иконка телефона в верхнем правом углу)
и перейдите в браузере по адресу http://localhost:8085. В PhpStorm должна открыться панель отладки.

**Примечание:** Если что-то не работает, попробуйте перезапустить Docker.
